<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="utf-8">
  <title>正弦團隊線上培訓系統</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="正弦團隊線上培訓系統">
  <link rel="stylesheet" href="css/stylesheet.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <script src="https://kit.fontawesome.com/bf96ebcbd9.js" crossorigin="anonymous"></script>
</head>
<body onload="checkCookie()">
  <!-- header -->
  <header>
    <nav class="navbar navbar-expand-lg bg-light">
      <div class="container-fluid">
        <a class="nav-link" href="#">
          <span>正弦團隊線上培訓系統</span>
        </a>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
            <li class="nav-item">
              <a class="nav-link" href="#">About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Pricing</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Contact</a>
            </li>
          </ul>
        </div>
        
        <!-- 登入前後 -->
        <div id="loginbar" class="text-end">
        </div>
        
      </div>
    </nav>
  </header>
  
  <!-- main -->
  <main>
    <section class="py-5 text-center container">
      <div class="row">
        <div class="col-lg-6 col-md-8 mx-auto">
          <h1 class="fw-light">Album example</h1>
          <p class="lead text-muted">Something short and leading about the collection below—its contents, the creator, etc. Make it short and sweet, but not too short so folks don’t simply skip over it entirely.</p>
          <p>
            <a href="#" class="btn btn-primary my-2" onclick="checkCourse()">View</a>
            <a href="#" class="btn btn-secondary my-2">Secondary action</a>
          </p>
        </div>
      </div>
    </section>

    <div class="album py-5 bg-light">
      <div class="container">
        <div id="online_courses" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
          
          <div class="col">
            <div class="card shadow-sm">
              <a class="d-block">
                <img class="img-thumbnail" src="#" with="100%" heigh="225" alt="img">
              </a>
              <div class="card-body">
                <span class="mb-1">沒有課程！</span>
                <h5 class="card-title mb-1">Thumbnail</h5>
                <p class="card-text">請購買課程！</p>
                <div class="d-flex justify-content-between align-items-center">
                  <div class="btn-group">
                    <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button>
                  </div>
                  <small class="text-muted">9 mins</small>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </main>

  <!-- footer -->
  <footer class="py-5">
    <div class="container">
      <div class="row">
        <div class="col col-6 col-md-3 mb-3">
          <h5>Section</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Home</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Features</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Pricing</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">FAQs</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">About</a></li>
          </ul>
        </div>
        <div class="col col-6 col-md-3 mb-3">
          <h5>Section</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Home</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Features</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Pricing</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">FAQs</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">About</a></li>
          </ul>
        </div>
        <div class="col col-6 col-md-3 mb-3">
          <h5>Section</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Home</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Features</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Pricing</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">FAQs</a></li>
            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">About</a></li>
          </ul>
        </div>
        <div class="col col-6 col-md-3 col-md-3">
          <p>關注我們</p>
          <div class="container">
            <div class="row">
              <div class="col col-3 col-md-1 col-sm-1">
                <a class="footer-link__ga" data-footer-more="Facebook" href="https://www.facebook.com/PTkevinchang" target="_blank"><i class="fa-brands fa-facebook-f"></i></a>
              </div>
              <div class="col col-3 col-md-1 col-sm-1">
                <a class="footer-link__ga" data-footer-more="Instagram" href="https://www.instagram.com/airlife917339" target="_blank"><i class="fa-brands fa-instagram"></i></a>
              </div>
              <div class="col col-3 col-md-1 col-sm-1">
                <a class="footer-link__ga" data-footer-more="LINE" href="#" target="_blank"><img class="line-icon___3Flhs" src="https://cdn-static.tibame.com/staticImages/footer/Line.svg" alt="Line"></a>
              </div>
              <div class="col col-3 col-md-1 col-sm-1 mb-3">
                <a class="footer-link__ga" data-footer-more="YouTube" href="https://www.youtube.com/@airlife917339" target="_blank"><i class="fa-brands fa-youtube"></i></a>
              </div>
            </div>
          </div>
          <div>
            <p>下載App</p>
          </div>
        </div>
      </div>
      <div class="d-flex flex-column flex-sm-row justify-content-between py-4 my-4 border-top">
        <p>© 2022 Kevin Chang. All rights reserved.</p>
      </div>
    </div>
  </footer>
  
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen-md-down">
      <div class="modal-content">
        
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel1">正弦團隊培訓系統</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        
        <div class="modal-body">
          <form id="login_form" action="?login_attempt=1" method="POST">
            <div>
              <h1 class="modal-title fs-5" id="exampleModalLabel2">登入培訓系統</h1>
            </div>
            <div class="form-floating">
              <input type="text" class="form-control" id="floatingInput" name="user" placeholder="name@example.com">
              <label for="floatingInput">Email address</label>
            </div>
            <div class="form-floating">
              <input type="password" class="form-control" id="floatingPassword" name="pwd" placeholder="Password">
              <label for="floatingPassword">Password</label>
            </div>

            <div class="checkbox mb-3">
              <label><input type="checkbox" value="remember-me">Remember me</label>
            </div>
            
            <div class="d-grid gap-2 col mx-auto">
              <input type="submit" value="提交" />
              <button class="btn btn-lg btn-primary" type="submit" onclick="login()">登入</button>
            </div>
            
            <div>
              <p><a href="#">忘記密碼？</a></p>
            </div>
          </form>
        </div>
        
        <div class="modal-footer">
          <div class="d-grid gap-2 col-4 mx-auto">
            <button type="button" class="btn btn-lg btn-success">建立新帳號</button>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script type="text/javascript">
    function checkCookie() {
      let loginbarhtml = document.getElementById("loginbar");
      let user = getCookie("username");
      let loginbartxt = "";
      if (user != "") {
        loginbartxt = "<a href=\"#\" class=\"d-block link-dark text-decoration-none dropdown-toggle\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">";
        loginbartxt+= "<img src=\"pic/mdo.jpg\" alt=\"profile picture\" class=\"rounded-circle\" width=\"32\" height=\"32\"></a>";
        loginbartxt+= "<ul class=\"dropdown-menu text-small\" style=\"position: absolute; inset: 0px 0px auto auto; margin: 0px; transform: translate(0px, 34px);\" data-popper-placement=\"bottom-end\">";
        loginbartxt+= "<li><a class=\"dropdown-item\" href=\"#\">New project...</a></li>";
        loginbartxt+= "<li><a class=\"dropdown-item\" href=\"#\">Settings</a></li>";
        loginbartxt+= "<li><a class=\"dropdown-item\" href=\"#\">Profile</a></li>";
        loginbartxt+= "<li><hr class=\"dropdown-divider\"></li>";
        loginbartxt+= "<li><a class=\"dropdown-item\" href=\"#\" onclick=\"logout()\">Sign out</a></li>";
        loginbartxt+= "</ul>";
      } else {
        loginbartxt = "<button type=\"button\" class=\"btn btn-outline-primary me-2\" data-bs-toggle=\"modal\" data-bs-target=\"#exampleModal\">Login</button>";
        loginbartxt+= "<button type=\"button\" class=\"btn btn-primary\">Sign-up</button>";
      }
      loginbarhtml.innerHTML = loginbartxt;
    }
    
    function getCookie(cname) {
      let name = cname + "=";
      let decodedCookie = decodeURIComponent(document.cookie);
      let ca = decodedCookie.split(';');
      for(let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') {
          c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
          return c.substring(name.length, c.length);
        }
      }
      return "";
    }
    
    function setCookie(cname, cvalue, exdays) {
      const d = new Date();
      d.setTime(d.getTime() + (exdays*24*60*60*1000));
      let expires = "expires=" + d.toUTCString();
      document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }
    
    function login() {
      //let closemodal = document.querySelector(".btn-close").click();
      let script_id = "AKfycbyFf_PHsaT1SKT_7NRukcmaigO0QxepC3nhR2tGB2izdAd1sXJfMjOXNFVHB3biGCko1A";
      let script_url = "https://script.google.com/macros/s/" + script_id + "/exec";
      let login_form = "#login_form";
      let user = document.querySelector("#floatingInput").value;
      let pwd = document.querySelector("#floatingPassword").value;
      let headers = {
          "Content-Type": "text/plain;charset=utf-8"
      };
      // 設置參數
      let data = {
          user: user,
          pwd: pwd
      };
      
      //parameters: 
      
      document.querySelector(login_form)
        .addEventListener('submit', (e) => {
          // 阻止表單送出
          e.preventDefault();
          
          console.log(data);
          
          // 送出 request
          fetch(script_url, {
            redirect: "follow",
            method: 'POST',
            headers: headers,
            body: JSON.stringify(data)
          }).then((response) => response.json())
            .then((response) => console.log(response))
        });
      //setCookie("username", user, 30);
      //checkCookie();
    }
    
    function logout() {
      let user = "";
      setCookie("username", user, 30);
      checkCookie();
    }
    
    function checkCourse() {
      let getCourse = document.getElementById("online_courses");
      course_arr = ['a', 'b', 'c', 'd', 'e'];
      course_str = "";
      course_arr.forEach(function(value, index, array){
        course_str+= "<div class=\"col\">";
        course_str+= "<div class=\"card shadow-sm\">";
        course_str+= "<a class=\"d-block\">";
        course_str+= "<img class=\"img-thumbnail\" src=\"https://img.youtube.com/vi/_B6fnv_zA0k/0.jpg\" with=\"100%\" heigh=\"225\" alt=\"img\">";
        course_str+= "</a>";
        course_str+= "<div class=\"card-body\">";
        course_str+= "<span class=\"mb-1\">主題課程 / 影音課程 / " + index + "</span>";
        course_str+= "<h5 class=\"card-title mb-1\">" + value +"</h5>";
        course_str+= "<p class=\"card-text\">This is a wider card with supporting text below as a natural lead-in to additional content. This content is a little bit longer.</p>";
        course_str+= "<div class=\"d-flex justify-content-between align-items-center\">";
        course_str+= "<div class=\"btn-group\">";
        course_str+= "<button type=\"button\" class=\"btn btn-sm btn-outline-secondary\">View</button>";
        course_str+= "<button type=\"button\" class=\"btn btn-sm btn-outline-secondary\">Edit</button>";
        course_str+= "</div>";
        course_str+= "<small class=\"text-muted\">9 mins</small>";
        course_str+= "</div>";
        course_str+= "</div>";
        course_str+= "</div>";
        course_str+= "</div>";
      });
      getCourse.innerHTML = course_str;
    }
    
    function saveIt(name) {
      let x = document.forms['cookieform'].cookievalue.value;
      if (!x)
        alert('Please fill in a value in the input box.');
      else {
        Cookies.create(name, x, 7);
        alert('Cookie created');
      }
    }

    function readIt(name) {
      alert('The value of the cookie is ' + Cookies[name]);
    }

    function eraseIt(name) {
      Cookies.erase(name);
      alert('Cookie erased');
    }

    function init() {
      for (let i=1;i<3;i++) {
        let x = Cookies['ppkcookie' + i];
        if (x) alert('Cookie ppkcookie' + i + '\nthat you set on a previous visit, is still active.\nIts value is ' + x);
      }
    }
    
  function createCookie(name,value,days) {
    if (days) {
      let date = new Date();
      date.setTime(date.getTime()+(days*24*60*60*1000));
      let expires = "; expires="+date.toGMTString();
    } else {
      let expires = "";
    }
    document.cookie = name+"="+value+expires+"; path=/";
  }

  function readCookie(name) {
    let nameEQ = name + "=";
    let ca = document.cookie.split(';');
    for(let i=0;i < ca.length;i++) {
      let c = ca[i];
      while (c.charAt(0)==' ') c = c.substring(1,c.length);
      if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
  }

  function eraseCookie(name) {
    createCookie(name,"",-1);
  }
  </script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
